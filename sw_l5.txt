create table DM_TBL (dmno number(8) not null primary key,custid varchar2(10),maildate date,contents varchar2(13 char),dept char(2),grade char(1),campain char(2));create table bookinfo_tbl(custid varchar2(10) not null primary key,author varchar2(20),goods char(2),phone varchar2(13),email varchar2(20),area varchar2(20));insert into dm_tbl values (1, 'aaa', TO_DATE('20171201', 'YYYYMMDD'),'안녕하세요?', '10', '1', 'C1');insert into dm_tbl values (2, 'bbb', TO_DATE('20171201', 'YYYYMMDD'),'안녕하세요?', '10', '2', 'C1');insert into dm_tbl values (3, 'ccc', TO_DATE('20171201', 'YYYYMMDD'),'안녕하세요?', '10', '3', 'C1');insert into dm_tbl values (4, 'ddd', TO_DATE('20171224', 'YYYYMMDD'),'안녕하세요?', '20', 'V', 'C2');insert into dm_tbl values (5, 'eee', TO_DATE('20171224', 'YYYYMMDD'),'안녕하세요?', '20', 'VV', 'C2');insert into dm_tbl values (6, 'fff', TO_DATE('20171224', 'YYYYMMDD'),'안녕하세요?', '30', '1', 'C3');insert into bookinfo_tbl values ('aaa', '김고객', '의류', '010-1111-1111', 'aaa@korea.com', '서울');insert into bookinfo_tbl values ('bbb', '이고객', '의류', '010-1111-1112', 'bbb@korea.com', '서울');insert into bookinfo_tbl values ('ccc', '박고객', '식료품', '010-1111-1113', 'ccc@korea.com', '경기');insert into bookinfo_tbl values ('ddd', '홍고객', '공산품', '010-1111-1114', 'ddd@korea.com', '대전');insert into bookinfo_tbl values ('eee', '조고객', '컴퓨터', '010-1111-1115', 'eee@korea.com', '대전');insert into bookinfo_tbl values ('fff', '백고객', '관광', '010-1111-1116', 'fff@korea.com', '울산');select t1.dmno, t1.custid, t2.author, to_char(t1.maildate, 'YYYY-MM-DD'), t1.contents, t1.campainfrom dm_tbl t1 join bookinfo_tbl t2on t1.custid=t2.custid;insert into bookinfo_tbl values(?, ?, ?, ?, ?, ?)select t2.area, Count(*)from dm_tbl t1 join bookinfo_tbl t2on t1.custid= t2.custidgroup by t2.area;create table custom_01 (p_id varchar2(10) not null primary key,p_pw varchar2(10),c_name varchar2(20),c_email varchar2(20),c_tel varchar2(14));insert into custom_01 values('aaa', '1234' , '김회원', 'aaa@korea.com', '010-1111-1111');insert into custom_01 values('bbb', '1234' , '이회원', 'bbb@korea.com', '010-1111-1112');insert into custom_01 values('ccc', '1234' , '박회원', 'ccc@korea.com', '010-1111-1113');insert into custom_01 values('ddd', '1234' , '오회원', 'ddd@korea.com', '010-1111-1114');insert into custom_01 values('eee', '1234' , '최회원', 'eee@korea.com', '010-1111-1115');insert into custom_01 values('fff', '1234' , '조회원', 'fff@korea.com', '010-1111-1116');create table dep_04(dpcode number(8) not null primary key,dpM varchar2(10) not null,detpt varchar2(10));create table em_04(name varchar2(10) not null,dpcode number(8) not null references dep_04(dpcode),emcode number(8) not null primary key,birth date,position number(5),rank number(5),phone varchar2(13),hiredate date);create table pay_04(name varchar2(10) not null,pycode number(8) not null primary key,emcode number(8) not null references em_04(emcode),pay1 varchar2(11),pay2 varchar2(11),bonus varchar2(11),pay3 varchar2(11),pay4 varchar2(11));insert into dep_04 values('1100', '김장', '인사');insert into dep_04 values('2100', '이장', '회계');insert into dep_04 values('3100', '박장', '영업');insert into dep_04 values('4100', '대장', '개발');insert into dep_04 values('5100', '소장', '홍보');insert into em_04 values('김장', '1100', '11', '1960-01-01', '1', '1', '010-1111-1111', '1989-01-01');insert into em_04 values('김장원', '1100', '12', '1970-01-01', '2', '4', '010-1111-1112', '1995-01-01');insert into em_04 values('김과장', '1100', '13', '1985-01-01', '3', '3', '010-1111-1113', '2005-01-01');insert into em_04 values('김대리', '1100', '14', '1990-01-01', '4', '6', '010-1111-1114', '2010-01-01');insert into em_04 values('김사원', '1100', '15', '1998-01-01', '5', '2', '010-1111-1115', '2020-01-01');insert into em_04 values('이장', '2100', '21', '1960-01-02', '1', '3', '010-1111-1121', '1989-01-01');insert into em_04 values('이장원', '2100', '22', '1970-01-02', '2', '3', '010-1111-1122', '1999-01-01');insert into em_04 values('이과장', '2100', '23', '1980-01-02', '3', '2', '010-1111-1123', '2005-01-01');insert into em_04 values('이대리', '2100', '24', '1990-01-02', '4', '4', '010-1111-1124', '2010-01-01');insert into em_04 values('박장', '3100', '31', '1960-01-03', '1', '1', '010-1111-1131', '1989-01-01');insert into em_04 values('박사원', '3100', '32', '1997-01-03', '5', '2', '010-1111-1132', '2020-01-01');insert into em_04 values('대장', '4100', '41', '1960-01-04', '1', '4', '010-1111-1141', '1989-01-01');insert into em_04 values('대사원', '4100', '42', '1999-01-04', '5', '5', '010-1111-1142', '2020-01-01');insert into em_04 values('소장', '5100', '51', '1960-01-05', '1', '2', '010-1111-1151', '1989-01-01');insert into em_04 values('소사원', '5100', '52', '2000-01-05', '5', '6', '010-1111-1151', '2020-01-01');insert into pay_04 values('김장', 11001, 11, '3500000', '0', '0', '0', '0');insert into pay_04 values('김장원', 11002, 12, '3000000', '0', '0', '0', '0');insert into pay_04 values('김과장', 11003, 13, '2500000', '0', '0', '0', '0');insert into pay_04 values('김대리', 11004, 14, '2000000', '0', '0', '0', '0');insert into pay_04 values('김사원', 11005, 15, '1500000', '0', '0', '0', '0');insert into pay_04 values('이장', 21001, 21, '3500000', '0', '0', '0', '0');insert into pay_04 values('이장원', 21002, 22, '3000000', '0', '0', '0', '0');insert into pay_04 values('이과장', 21003, 23, '2500000', '0', '0', '0', '0');insert into pay_04 values('이대리', 21004, 24, '2000000', '0', '0', '0', '0');insert into pay_04 values('박장', 31001, 31, '3500000', '0', '0', '0', '0');insert into pay_04 values('박사원', 31002, 32, '1500000', '0', '0', '0', '0');insert into pay_04 values('대장', 41001, 41, '3500000', '0', '0', '0', '0');insert into pay_04 values('대사원', 41002, 42, '1500000', '0', '0', '0', '0');insert into pay_04 values('소장', 51001, 51, '3500000', '0', '0', '0', '0');insert into pay_04 values('소사원', 51002, 52, '1500000', '0', '0', '0', '0');update (select * from em_04 e, pay_04 p where e.emcode = p.emcode)set bonus = (case when position = 3 then '50000'when position = 4 then '100000'when position = 5 then '150000'else '0'end);select detpt 부서명, name 이름, extract(year from sysdate) - extract(year from birth) 나이from dep_04 join em_04 using(dpcode);update (select *from pay_04 pjoin em_04 e on e.emcode = p.emcode)set pay3 = (case 	when position = 1  then '200000'	when position = 2 then '100000'	when position = 3 then '50000'	else '0'end);update pay_04set pay2 = '50000', pay4 ='50000';update (select *from pay_04 pjoin em_04 e on e.emcode = p.emcode)set bonus = (case 	when position = 3  then '50000'	when position = 4 then '100000'	when position = 5 then '150000'	else '0'end);select p.emcode 사원코드, to_char(hiredate, 'YYYY-MM') 입사일, to_char(pay1, '9,999,999L') 기본급,to_char(pay2, '999,999L') 교통비, to_char(bonus, '999,999L') 보너스, to_char(pay3, '999,999L') 수당,to_char(pay4, '999,999L')식대, to_char((to_number(pay1)+to_number(pay2)+to_number(bonus)+to_number(pay3)+to_number(pay4)), '9,999,999L') 합계from pay_04 pjoin em_04 e on e.emcode = p.emcodeorder by 합계 desc;